let parens_ok str =
  let char_list = List.of_seq (String.to_seq str) in
  let rec check_parens stack c_l =
    match c_l with
    | [] -> stack = []
    | '(' :: tl -> check_parens (')' :: stack) tl
    | '[' :: tl -> check_parens (']' :: stack) tl
    | '{' :: tl -> check_parens ('}' :: stack) tl
    | c :: tl -> match stack with
      | [] -> false
      | top :: stack_tl -> if c = top then check_parens stack_tl tl else false
  in
  check_parens [] char_list

